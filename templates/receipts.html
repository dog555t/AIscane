{% extends 'base.html' %}
{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
    <h3 style="font-family: 'Courier New', Courier, monospace; font-weight: bold;">
        ğŸ“š Receipt History
    </h3>
    <form class="d-flex search-container" method="get" style="width: 400px; max-width: 100%;">
        <input class="form-control me-2" type="search" name="search" placeholder="ğŸ” Search vendor, text..." value="{{ search or '' }}">
        <button class="btn btn-outline-primary" type="submit">Search</button>
    </form>
</div>

<div class="card shadow-sm mb-3">
    <div class="card-body">
        <p class="mb-0 text-muted small">
            ğŸ’¡ <strong>Tip:</strong> Click on column headers to sort. Use the search box to filter receipts.
        </p>
    </div>
</div>

<div class="table-responsive bg-white shadow-sm">
    <table class="table table-striped table-hover mb-0">
        <thead>
            <tr>
                <th><a href="?sort=created_at&order={{ 'asc' if order=='desc' else 'desc' }}" title="Sort by creation date">ğŸ•’ Created</a></th>
                <th><a href="?sort=vendor&order={{ 'asc' if order=='desc' else 'desc' }}" title="Sort by vendor">ğŸª Vendor</a></th>
                <th><a href="?sort=date&order={{ 'asc' if order=='desc' else 'desc' }}" title="Sort by receipt date">ğŸ“… Date</a></th>
                <th><a href="?sort=total&order={{ 'asc' if order=='desc' else 'desc' }}" title="Sort by total amount">ğŸ’° Total</a></th>
                <th>ğŸ§¾ Tax</th>
                <th>ğŸ–¼ï¸ Image</th>
                <th></th>
            </tr>
        </thead>
        <tbody>
            {% for r in receipts %}
            <tr>
                <td><small>{{ r.created_at }}</small></td>
                <td><strong>{{ r.vendor }}</strong></td>
                <td>{{ r.date }}</td>
                <td><strong>${{ r.total }}</strong></td>
                <td>${{ r.tax }}</td>
                <td>
                    {% if r.image_path %}
                        <span class="badge bg-success">âœ“</span>
                    {% else %}
                        <span class="badge bg-secondary">â€”</span>
                    {% endif %}
                </td>
                <td>
                    <a class="btn btn-sm btn-primary" href="/receipts/{{ r.id }}">
                        ğŸ‘ï¸ View
                    </a>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

{% if not receipts %}
<div class="card shadow-sm mt-4">
    <div class="card-body text-center py-5">
        <h5 class="text-muted">ğŸ“­ No receipts found</h5>
        <p class="text-muted">Start by scanning or uploading your first receipt!</p>
        <a href="/scan" class="btn btn-primary">ğŸ“· Scan Receipt</a>
        <a href="/upload" class="btn btn-outline-secondary">ğŸ“¤ Upload Image</a>
    </div>
</div>
{% endif %}
{% endblock %}
